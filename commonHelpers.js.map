{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from \"axios\";\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  nav: true,\n  captionDelay: 250,\n  captionsData: 'alt',\n  close: true,\n  enableKeyboard: true,\n  docClose: true,\n});\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst buttonLoadMore = document.querySelector('.second-btn');\n\nlet page = 1; \nlet isLastPage = false;\n\n\nconst api = axios.create({\n  baseURL: \"https://pixabay.com/api/\",\n  params: { \n    key: \"41526940-8233d9bee139c8a54ba6bf59b\",\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 40,\n  }\n});\n\nfunction renderImages(images = []) { \n  const markup = images.reduce((html, { largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => {\n    return html +\n      `<li class=\"gallery-item\">\n        <a href=${largeImageURL}> \n          <img class=\"gallery-img\" src =${webformatURL} alt=${tags}/>\n        </a>\n        <div class=\"gallery-text-box\">\n          <p>Likes: <span class=\"text-value\">${likes}</span></p>\n          <p>Views: <span class=\"text-value\">${views}</span></p>\n          <p>Comments: <span class=\"text-value\">${comments}</span></p>\n          <p>Downloads: <span class=\"text-value\">${downloads}</span></p>\n        </div>\n       </li>`\n    }, '');\n  gallery.insertAdjacentHTML(\"beforeend\", markup);\n}\n\nconst getImages = async (params) => { \n  try { \n    const response = await api.get(\"\", { params });\n    return response.data;\n  } catch(response) { \n    throw new Error(response.statusText);\n  }\n}\n\nconst createRequestToGetImages = async q => { \n  const per_page = 40;\n  \n  try { \n    if(isLastPage) { \n      return;\n    }\n\n    const { hits, totalHits } = await getImages({ page, per_page, q});\n\n    if (page >= Math.ceil(totalHits / per_page)) { \n      isLastPage = true;\n    }\n\n    page += 1;\n\n    renderImages(hits);\n    buttonLoadMore.style.display = \"block\";\n\n    lightbox.refresh();\n  } catch(error) { \n      iziToast.error({\n        position: 'topRight',\n        maxWidth: 432,\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n  } finally { \n      loader.style.display = 'none';\n  }\n}\n\nform.addEventListener('submit', async (event) => {\n  event.preventDefault();\n\n  gallery.innerHTML = '';\n\n  loader.style.display = 'block';\n  \n  let query = '';\n\n  if (form.elements.search.value.trim() != query) { \n    page = 1;\n  }\n\n  query = form.elements.search.value.trim();\n\n  const images = await createRequestToGetImages(query); \n});\n\nbuttonLoadMore.addEventListener('click', async (event) => { \n  event.preventDefault();\n\n  loader.style.display = 'block';\n\n  const query = form.elements.search.value.trim();\n\n  const images = await createRequestToGetImages(query); \n\n  const galleryItemHeight = document.querySelector('.gallery-item').getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: galleryItemHeight * 2, \n    behavior: 'smooth'\n  });\n\n\n  if (isLastPage) { \n    buttonLoadMore.style.display = \"none\";\n    iziToast.info({\n      position: 'topRight',\n      maxWidth: 432,\n      message:\n        \"We're sorry, but you've reached the end of search results.\"\n    });\n  }\n});\n\n"],"names":["lightbox","SimpleLightbox","form","gallery","loader","buttonLoadMore","page","isLastPage","api","axios","renderImages","images","markup","html","largeImageURL","webformatURL","tags","likes","views","comments","downloads","getImages","params","response","createRequestToGetImages","q","hits","totalHits","iziToast","event","query","galleryItemHeight"],"mappings":"owBAMA,MAAMA,EAAW,IAAIC,EAAe,aAAc,CAChD,IAAK,GACL,aAAc,IACd,aAAc,MACd,MAAO,GACP,eAAgB,GAChB,SAAU,EACZ,CAAC,EAEKC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,aAAa,EAE3D,IAAIC,EAAO,EACPC,EAAa,GAGjB,MAAMC,EAAMC,EAAM,OAAO,CACvB,QAAS,2BACT,OAAQ,CACN,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,EACX,CACH,CAAC,EAED,SAASC,EAAaC,EAAS,GAAI,CACjC,MAAMC,EAASD,EAAO,OAAO,CAACE,EAAM,CAAE,cAAAC,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IACjGP,EACL;AAAA,kBACYC;AAAA,0CACwBC,SAAoBC;AAAA;AAAA;AAAA,+CAGfC;AAAA,+CACAC;AAAA,kDACGC;AAAA,mDACCC;AAAA;AAAA,cAG5C,EAAE,EACPjB,EAAQ,mBAAmB,YAAaS,CAAM,CAChD,CAEA,MAAMS,EAAY,MAAOC,GAAW,CAClC,GAAI,CAEF,OADiB,MAAMd,EAAI,IAAI,GAAI,CAAE,OAAAc,CAAM,CAAE,GAC7B,IACjB,OAAOC,EAAN,CACA,MAAM,IAAI,MAAMA,EAAS,UAAU,CACpC,CACH,EAEMC,EAA2B,MAAMC,GAAK,CAG1C,GAAI,CACF,GAAGlB,EACD,OAGF,KAAM,CAAE,KAAAmB,EAAM,UAAAC,CAAS,EAAK,MAAMN,EAAU,CAAE,KAAAf,EAAM,YAAU,EAAAmB,CAAC,CAAC,EAE5DnB,GAAQ,KAAK,KAAKqB,EAAY,EAAQ,IACxCpB,EAAa,IAGfD,GAAQ,EAERI,EAAagB,CAAI,EACjBrB,EAAe,MAAM,QAAU,QAE/BL,EAAS,QAAO,CACjB,MAAC,CACE4B,EAAS,MAAM,CACb,SAAU,WACV,SAAU,IACV,QACE,0EACV,CAAO,CACP,QAAY,CACNxB,EAAO,MAAM,QAAU,MAC1B,CACH,EAEAF,EAAK,iBAAiB,SAAU,MAAO2B,GAAU,CAC/CA,EAAM,eAAc,EAEpB1B,EAAQ,UAAY,GAEpBC,EAAO,MAAM,QAAU,QAEvB,IAAI0B,EAAQ,GAER5B,EAAK,SAAS,OAAO,MAAM,KAAM,GAAI4B,IACvCxB,EAAO,GAGTwB,EAAQ5B,EAAK,SAAS,OAAO,MAAM,KAAI,EAExB,MAAMsB,EAAyBM,CAAK,CACrD,CAAC,EAEDzB,EAAe,iBAAiB,QAAS,MAAOwB,GAAU,CACxDA,EAAM,eAAc,EAEpBzB,EAAO,MAAM,QAAU,QAEvB,MAAM0B,EAAQ5B,EAAK,SAAS,OAAO,MAAM,OAE1B,MAAMsB,EAAyBM,CAAK,EAEnD,MAAMC,EAAoB,SAAS,cAAc,eAAe,EAAE,sBAAuB,EAAC,OAE1F,OAAO,SAAS,CACd,IAAKA,EAAoB,EACzB,SAAU,QACd,CAAG,EAGGxB,IACFF,EAAe,MAAM,QAAU,OAC/BuB,EAAS,KAAK,CACZ,SAAU,WACV,SAAU,IACV,QACE,4DACR,CAAK,EAEL,CAAC"}